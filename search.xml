<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>iOSå¤šçº¿ç¨‹çŸ¥è¯†æ¢³ç†</title>
    <url>/2019/10/18/iOS%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/</url>
    <content><![CDATA[<h2 id="è¿›ç¨‹ã€çº¿ç¨‹ä¸é˜Ÿåˆ—"><a href="#è¿›ç¨‹ã€çº¿ç¨‹ä¸é˜Ÿåˆ—" class="headerlink" title="è¿›ç¨‹ã€çº¿ç¨‹ä¸é˜Ÿåˆ—"></a>è¿›ç¨‹ã€çº¿ç¨‹ä¸é˜Ÿåˆ—</h2><h3 id="è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹"></a>è¿›ç¨‹ä¸çº¿ç¨‹</h3><ul>
<li>è¿›ç¨‹æ˜¯ç³»ç»Ÿä¸­æ­£åœ¨è¿è¡Œçš„ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªè¿›ç¨‹ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªè¿›ç¨‹å‡è¿è¡Œåœ¨ä¸“ç”¨ä¸”å—ä¿æŠ¤çš„å†…å­˜ç©ºé—´å†…</li>
<li>çº¿ç¨‹æ˜¯è¿›ç¨‹çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä»»åŠ¡éƒ½åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ä¸€ä¸ªè¿›ç¨‹ç”±è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ç»„æˆ</li>
</ul>
<h3 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h3><p>ä¸€ä¸ªçº¿ç¨‹ä¸­çš„ä»»åŠ¡æ˜¯ä¸²è¡Œçš„ï¼ŒåŒä¸€æ—¶é—´å†…ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚</p>
<p>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥å¼€å¯å¤šæ¡çº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚åŒä¸€æ—¶é—´ï¼ŒCPUåªèƒ½å¤„ç†ä¸€æ¡çº¿ç¨‹ï¼Œå¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œæ˜¯CPUå¿«é€Ÿåœ°åœ¨å¤šæ¡çº¿ç¨‹ä¹‹é—´è°ƒåº¦</p>
<p>iOSçš„å¤šçº¿ç¨‹æŠ€æœ¯æœ‰ï¼š<code>pthread</code>ã€<code>NSThread</code>ã€<code>GCD</code>ã€<code>NSOperation</code></p>
<h3 id="ä¸»çº¿ç¨‹"><a href="#ä¸»çº¿ç¨‹" class="headerlink" title="ä¸»çº¿ç¨‹"></a>ä¸»çº¿ç¨‹</h3><p>ä¸»çº¿ç¨‹ä¸»è¦è´Ÿè´£æ˜¾ç¤ºå’Œåˆ·æ–°UIç•Œé¢ï¼Œå¤„ç†UIäº‹ä»¶</p>
<h3 id="é˜Ÿåˆ—çš„ç±»å‹"><a href="#é˜Ÿåˆ—çš„ç±»å‹" class="headerlink" title="é˜Ÿåˆ—çš„ç±»å‹"></a>é˜Ÿåˆ—çš„ç±»å‹</h3><ul>
<li>ä¸»é˜Ÿåˆ—ï¼š<code>dispatch_get_main_queue</code></li>
<li>å…¨å±€å¹¶å‘é˜Ÿåˆ—ï¼š<code>dispatch_get_global_queue</code></li>
<li>è‡ªå·±åˆ›å»ºé˜Ÿåˆ—ï¼š<code>dispatch_queue_create</code></li>
</ul>
<h2 id="çº¿ç¨‹é€šä¿¡"><a href="#çº¿ç¨‹é€šä¿¡" class="headerlink" title="çº¿ç¨‹é€šä¿¡"></a>çº¿ç¨‹é€šä¿¡</h2><p>GCD:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#x2F;&#x2F; åœ¨è¿™é‡Œæ‰§è¡Œè€—æ—¶æ“ä½œ</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">         &#x2F;&#x2F; å›åˆ°ä¸»çº¿ç¨‹ï¼Œæ‰§è¡ŒUIåˆ·æ–°æ“ä½œ</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>



<p>NSOperationQueue:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[[NSOperationQueue new] addOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;å­çº¿ç¨‹ä¸‹è½½: %@&quot;, NSOperationQueue.currentQueue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    [[NSOperationQueue mainQueue] addOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;ä¸»çº¿ç¨‹åˆ·æ–°UI: %@&quot;, NSOperationQueue.currentQueue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr></table></figure>



<h2 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h2><p>æ­»é”å°±æ˜¯é˜Ÿåˆ—å¼•èµ·çš„å¾ªç¯ç­‰å¾…ï¼šåœ¨ä¸²è¡Œé˜Ÿåˆ—Aä¸­å‘é˜Ÿåˆ—Aæ·»åŠ ä¸€ä¸ªåŒæ­¥ä»»åŠ¡ï¼Œä¾‹å¦‚ä¸»é˜Ÿåˆ—åŒæ­¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    [super viewDidLoad];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_sync(dispatch_get_main_queue(), ^&#123; &#x2F;&#x2F; ğŸ‘ˆæ­»é”åœ¨è¿™ä¸€è¡Œ</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#x2F;&#x2F; NSLog(@&quot;åœ¨ä¸»é˜Ÿåˆ—åŒæ­¥æ‰§è¡Œ&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>æˆ–è€…åœ¨è‡ªå®šä¹‰çº¿ç¨‹ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; NOT OK</span></pre></td></tr><tr><td class="code"><pre><span class="line">- (void)test1 &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;åœ¨ä¸»çº¿ç¨‹æ·»åŠ ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—queue&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_queue_t queue &#x3D; dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_async(queue, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;åœ¨ä¸²è¡Œé˜Ÿåˆ—queueä¸­æ·»åŠ ä¸€ä¸ªåŒæ­¥ä»»åŠ¡&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dispatch_sync(queue, ^&#123; &#x2F;&#x2F; ğŸ‘ˆæ­»é”åœ¨è¿™ä¸€è¡Œ</span></pre></td></tr><tr><td class="code"><pre><span class="line">            NSLog(@&quot;OK&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; è¿™æ ·å°±ä¸ä¼šæ­»é”äº†</span></pre></td></tr><tr><td class="code"><pre><span class="line">- (void)test2 &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;åœ¨ä¸»çº¿ç¨‹æ·»åŠ ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—queue&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_queue_t queue &#x3D; dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_queue_t queue2 &#x3D; dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_SERIAL);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_async(queue, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;åœ¨ä¸²è¡Œé˜Ÿåˆ—queue2ä¸­æ·»åŠ ä¸€ä¸ªåŒæ­¥ä»»åŠ¡&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        dispatch_sync(queue2, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            NSLog(@&quot;OK&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="çº¿ç¨‹ç®¡ç†"><a href="#çº¿ç¨‹ç®¡ç†" class="headerlink" title="çº¿ç¨‹ç®¡ç†"></a>çº¿ç¨‹ç®¡ç†</h2><h3 id="è®¾ç½®æœ€å¤§å¹¶å‘æ•°"><a href="#è®¾ç½®æœ€å¤§å¹¶å‘æ•°" class="headerlink" title="è®¾ç½®æœ€å¤§å¹¶å‘æ•°"></a>è®¾ç½®æœ€å¤§å¹¶å‘æ•°</h3><p>NSOperationQueueï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- (void)setMaxConcurrentOperationCount:(NSInteger)cnt;</span></pre></td></tr></table></figure>

<h3 id="è®¾ç½®ä¾èµ–"><a href="#è®¾ç½®ä¾èµ–" class="headerlink" title="è®¾ç½®ä¾èµ–"></a>è®¾ç½®ä¾èµ–</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSOperationQueue *queue &#x3D; [[NSOperationQueue alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">NSOperation *op1 &#x3D; [NSBlockOperation blockOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    sleep(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;ä¸‹è½½å›¾ç‰‡1&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">NSOperation *op2 &#x3D; [NSBlockOperation blockOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    sleep(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;ä¸‹è½½å›¾ç‰‡2&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">NSOperation *combine &#x3D; [NSBlockOperation blockOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;åˆæˆå›¾ç‰‡&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[combine addDependency:op1];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[combine addDependency:op2];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">[queue addOperation:op1];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[queue addOperation:op2];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[queue addOperation:combine];</span></pre></td></tr></table></figure>

<h3 id="è®¾ç½®æ …æ "><a href="#è®¾ç½®æ …æ " class="headerlink" title="è®¾ç½®æ …æ "></a>è®¾ç½®æ …æ </h3><p>è‹¥å¹²ä¸ªç½‘ç»œè¯·æ±‚ç»“æŸåæ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dispatch_queue_t queue &#x3D; dispatch_queue_create(&quot;test&quot;, DISPATCH_QUEUE_CONCURRENT);</span></pre></td></tr><tr><td class="code"><pre><span class="line">dispatch_group_t group &#x3D; dispatch_group_create();</span></pre></td></tr><tr><td class="code"><pre><span class="line">for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_group_async(group, queue, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        sleep(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;ç½‘ç»œè¯·æ±‚   ---- %d&quot;,i);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">dispatch_barrier_sync(queue, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;ä¸»çº¿ç¨‹åˆ·æ–°UI&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>é€šè¿‡NSOperationQueueå®ç°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NSOperationQueue *queue &#x3D; [[NSOperationQueue alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSOperation *op &#x3D; [NSBlockOperation blockOperationWithBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        sleep(1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;ç½‘ç»œè¯·æ±‚   ---- %d&quot;,i);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    [queue addOperation:op];</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">[queue addBarrierBlock:^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;åˆ·æ–°é¡µé¢&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr></table></figure>



<h3 id="çº¿ç¨‹ç»„"><a href="#çº¿ç¨‹ç»„" class="headerlink" title="çº¿ç¨‹ç»„"></a>çº¿ç¨‹ç»„</h3><p>åœ¨nä¸ªè€—æ—¶å¹¶å‘ä»»åŠ¡éƒ½å®Œæˆåï¼Œå†å»æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡ã€‚æ¯”å¦‚ï¼Œåœ¨nä¸ªç½‘ç»œè¯·æ±‚å®Œæˆåå»åˆ·æ–°UIé¡µé¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dispatch_queue_t queue &#x3D; dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);</span></pre></td></tr><tr><td class="code"><pre><span class="line">dispatch_group_t group &#x3D; dispatch_group_create();</span></pre></td></tr><tr><td class="code"><pre><span class="line">for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    dispatch_group_async(group, queue, ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        NSLog(@&quot;ç½‘ç»œè¯·æ±‚   ---- %d&quot;,i);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    NSLog(@&quot;åˆ·æ–°é¡µé¢&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<h2 id="GCDå’ŒNSOperationæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#GCDå’ŒNSOperationæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="GCDå’ŒNSOperationæœ‰ä»€ä¹ˆåŒºåˆ«"></a>GCDå’ŒNSOperationæœ‰ä»€ä¹ˆåŒºåˆ«</h2><ul>
<li>GCDæ˜¯çº¯Cè¯­è¨€çš„APIï¼›NSOperationæ˜¯åŸºäºGCDçš„OCç‰ˆæœ¬å°è£…</li>
<li>GCDåªæ”¯æŒFIFOçš„é˜Ÿåˆ—ï¼›NSOperationå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è°ƒæ•´æ‰§è¡Œé¡ºåºï¼Œè®¾ç½®æœ€å¤§å¹¶å‘æ•°é‡</li>
<li>NSOperationQueueå¯ä»¥è½»æ¾åœ¨operationé—´è®¾ç½®ä¾èµ–å…³ç³»ï¼Œè€ŒGCDéœ€è¦äº›å¾ˆå¤šä»£ç æ‰èƒ½å®ç°</li>
<li>NSOperationQueueæ”¯æŒKVOï¼Œå¯ä»¥æ£€æµ‹operationæ˜¯å¦æ­£åœ¨æ‰§è¡Œ(isExecuted)ï¼Œæ˜¯å¦ç»“æŸ(isFinish),æ˜¯å¦å–æ¶ˆ(isCancel)</li>
<li>GCDçš„æ‰§è¡Œé€Ÿåº¦æ¯”NSOperationå¿«</li>
</ul>
]]></content>
      <tags>
        <tag>å¤šçº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>SwiftUIå®è·µDemo</title>
    <url>/2019/10/17/SwiftUI%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E5%8F%8A%E5%AE%9E%E8%B7%B5/</url>
    <content><![CDATA[<h1 id="SwiftUIå…¥é—¨å­¦ä¹ å®è·µ"><a href="#SwiftUIå…¥é—¨å­¦ä¹ å®è·µ" class="headerlink" title="SwiftUIå…¥é—¨å­¦ä¹ å®è·µ"></a>SwiftUIå…¥é—¨å­¦ä¹ å®è·µ</h1><p><a href="https://developer.apple.com/documentation/swiftui/" target="_blank" rel="noopener">Apple Developer SwiftUI</a></p>
<p><img src="https://i.loli.net/2019/11/27/iM8IsLBGhWgzvTX.png" alt="SwiftUIé€šç”¨å¼€å‘"></p>
<h3 id="ä¸€ã€SwiftUIæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸€ã€SwiftUIæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸€ã€SwiftUIæ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä¸€ã€SwiftUIæ˜¯ä»€ä¹ˆï¼Ÿ</h3><h5 id="1-å®šä¹‰ï¼š"><a href="#1-å®šä¹‰ï¼š" class="headerlink" title="1. å®šä¹‰ï¼š"></a>1. å®šä¹‰ï¼š</h5><p><code>SwiftUI</code>æ˜¯è‹¹æœåœ¨ <strong>â€œWWDC-2019â€</strong> æ¨å‡ºçš„ä¸€æ¬¾å…¨æ–°çš„ <strong>â€œå£°æ˜å¼UIâ€</strong> æ¡†æ¶ã€‚ æ‹†å¼€çœ‹ï¼Œ<code>Swift</code> + <code>UI</code>ï¼Œå³åŸºäºSwiftè¯­è¨€åŸºç¡€è¯­æ³•çš„UIæ¡†æ¶</p>
<h5 id="2-ç‰¹ç‚¹ï¼š"><a href="#2-ç‰¹ç‚¹ï¼š" class="headerlink" title="2. ç‰¹ç‚¹ï¼š"></a>2. ç‰¹ç‚¹ï¼š</h5><ul>
<li><strong>â€œç®€æ´è¿…é€Ÿâ€çš„Swift</strong>ï¼šè¶Šæ¥è¶Šç®€æ´çš„<code>Swift</code>è¯­æ³•ï¼Œé…ä¸Š<code>Swift</code>è¿…é€Ÿçš„ä¼˜åŠ¿</li>
<li><strong>â€œå³è§†â€çš„UI</strong>ï¼šé™ä½è°ƒè¯•æˆæœ¬ï¼Œä¸€è¾¹å†™<code>code</code>ã€ä¸€è¾¹å°±å¯å®æ—¶é¢„è§ˆæŸ¥çœ‹<code>UI</code>ç•Œé¢</li>
<li><strong>è·¨å¹³å°</strong>ï¼šä¸€å¥—ä»£ç ï¼Œå³å¯å®Œæˆ<code>iOS</code>ã€<code>iPadOS</code>ã€<code>macOS</code>ã€<code>watchOS</code>çš„å¼€å‘ä¸é€‚é…</li>
</ul>
<p><img src="https://i.loli.net/2019/11/24/I8Aq2jNUtpgQ5Ke.png" alt="è·¨å¹³å°"></p>
<ul>
<li><strong>â€œå£°æ˜å¼â€ç¼–ç¨‹</strong>ï¼š</li>
</ul>
<p>å¯¹æ¯”ä¹‹å‰çš„ <strong>â€œæŒ‡ä»¤å¼â€ç¼–ç¨‹</strong>ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å‘Šè¯‰è®¡ç®—æœº<strong>â€œæ€ä¹ˆåšâ€</strong>ï¼Ÿ è€Œ<strong>â€œå£°æ˜å¼â€ç¼–ç¨‹</strong>æ˜¯è®©æˆ‘ä»¬å‘Šè¯‰è®¡ç®—æœº <strong>â€œåšä»€ä¹ˆâ€</strong>ï¼Ÿï¼ˆè‡³äºæœ€åº•å±‚æ€ä¹ˆåšï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒï¼‰</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºå†™UIè€Œè¨€ï¼Œ</p>
<ul>
<li>æŒ‡ä»¤å¼ç¼–ç¨‹ï¼šå°±æ˜¯ï¼Œ<strong>æ€ä¹ˆç”»ï¼Ÿ</strong> æŠŠæ¯ä¸ª<code>frame</code>ã€<code>layout</code>ç­‰ç­‰ç»Ÿç»Ÿéœ€è¦è®¡ç®—åˆ°ä½</li>
<li>å£°æ˜å¼ç¼–ç¨‹ï¼šå°±æ˜¯ï¼Œ<strong>ç”»ä»€ä¹ˆï¼Ÿ</strong> æŠŠæƒ³è¦çš„æ•ˆæœæè¿°å‡ºæ¥ï¼Œå…¶ä»–éƒ½äº¤ç»™æ¡†æ¶å»åš</li>
</ul>
<h5 id="3-å¼€å‘ç¯å¢ƒï¼š"><a href="#3-å¼€å‘ç¯å¢ƒï¼š" class="headerlink" title="3. å¼€å‘ç¯å¢ƒï¼š"></a>3. å¼€å‘ç¯å¢ƒï¼š</h5><p>è¿™ä¹ˆæ–°çš„æŠ€æœ¯è‚¯å®šéœ€è¦ç¯å¢ƒçš„æ”¯æŒã€‚<code>SwiftUI</code>æ‰€éœ€è¦çš„å¼€å‘ç¯å¢ƒï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>Xcodeï¼š<code>Xcode 11.1+</code></li>
<li>MacOSï¼š<code>MacOS 10.15+</code></li>
<li>iOSï¼š<code>iOS 13+</code></li>
</ul>
<blockquote>
<p><em>PSï¼šç”±äº<code>SwiftUI</code>åªèƒ½åº”ç”¨ä¸<code>iOS 13</code>ç³»ç»Ÿä»¥ä¸Šçš„è®¾å¤‡ã€‚ å› æ­¤ï¼Œè¿™é¡¹æŠ€æœ¯ä¸å»ºè®®ç”¨åœ¨éœ€è¦é€‚é…ä½ç‰ˆæœ¬ï¼ˆ<code>iOS 13</code> ä»¥ä¸‹ï¼‰çš„Appä¸Šã€‚ ä¸è¿‡å¦‚æœæ˜¯æ— éœ€é€‚é…ä½ç‰ˆæœ¬çš„æ–°é¡¹ç›®ï¼Œæˆ–è€…å­¦ä¹ è€…å…¨å¯ä»¥ä¸Šæ‰‹â€œç©ä¸€ç©â€ã€‚ æ¯•ç«Ÿè‹¹æœçš„æ–°æŠ€æœ¯è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„å˜›~</em></p>
</blockquote>
<h3 id="äºŒã€SwiftUIçš„åŸºæœ¬ç»„ä»¶ï¼ˆè¯­æ³•ï¼‰"><a href="#äºŒã€SwiftUIçš„åŸºæœ¬ç»„ä»¶ï¼ˆè¯­æ³•ï¼‰" class="headerlink" title="äºŒã€SwiftUIçš„åŸºæœ¬ç»„ä»¶ï¼ˆè¯­æ³•ï¼‰"></a>äºŒã€SwiftUIçš„åŸºæœ¬ç»„ä»¶ï¼ˆè¯­æ³•ï¼‰</h3><blockquote>
<p>è¿™å—çŸ¥è¯†æ¯”è¾ƒâ€œåŸºç¡€â€ä¸”â€œé‡è¦â€ã€‚åªæœ‰è®°ä½äº†è¿™äº›åŸºæœ¬ç»„ä»¶ï¼Œæ‰èƒ½ç”¨è¾ƒå°‘çš„ä»£ç å¼€å‘å‡ºç²¾ç¾çš„App</p>
</blockquote>
<p>ä¸‹é¢æ˜¯ä¸€äº›é‡è¦çš„<code>SwiftUI</code>ç»„ä»¶ï¼š</p>
<p><strong>ç»„ä»¶ä»‹ç»</strong></p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>Text</td>
<td>ç”¨æ¥æ˜¾ç¤ºæ–‡æœ¬çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UILabel</code></td>
</tr>
<tr>
<td>Image</td>
<td>ç”¨æ¥å±•ç¤ºå›¾ç‰‡çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIImageView</code></td>
</tr>
<tr>
<td>Button</td>
<td>ç”¨äºå¯ç‚¹å‡»çš„æŒ‰é’®ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIButton</code></td>
</tr>
<tr>
<td>List</td>
<td>ç”¨æ¥å±•ç¤ºåˆ—è¡¨çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UITableView</code></td>
</tr>
<tr>
<td>ScrollView</td>
<td>ç”¨æ¥æ”¯æŒæ»‘åŠ¨çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIScrollView</code></td>
</tr>
<tr>
<td>Spacer</td>
<td>ä¸€ä¸ªçµæ´»çš„ç©ºé—´ï¼Œç”¨æ¥å¡«å……ç©ºç™½çš„ç»„ä»¶</td>
</tr>
<tr>
<td>Divider</td>
<td>ä¸€æ¡åˆ†å‰²çº¿ï¼Œç”¨æ¥åˆ’åˆ†åŒºåŸŸçš„ç»„ä»¶</td>
</tr>
<tr>
<td>VStack</td>
<td>å°†å­è§†å›¾æŒ‰<strong>â€œç«–ç›´æ–¹å‘â€</strong>æ’åˆ—å¸ƒå±€ã€‚ï¼ˆ<code>Vertical stack</code>ï¼‰</td>
</tr>
<tr>
<td>HStack</td>
<td>å°†å­è§†å›¾æŒ‰<strong>â€œæ°´å¹³æ–¹å‘â€</strong>æ’åˆ—å¸ƒå±€ã€‚ï¼ˆ<code>Horizontal stack</code>ï¼‰</td>
</tr>
<tr>
<td>ZStack</td>
<td>å°†å­è§†å›¾æŒ‰<strong>â€œä¸¤è½´æ–¹å‘å‡å¯¹é½â€</strong>å¸ƒå±€ï¼ˆå±…ä¸­ï¼Œæœ‰é‡å æ•ˆæœï¼‰</td>
</tr>
</tbody></table>
<p><strong>åŸºæœ¬ç»„ä»¶</strong></p>
<ul>
<li>Textï¼šç”¨æ¥æ˜¾ç¤ºæ–‡æœ¬çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UILabel</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">"Hello, we are QiShare!"</span>).foregroundColor(.blue).font(.system(size: <span class="number">32.0</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">å¤åˆ¶ä»£ç </span></pre></td></tr></table></figure>

<ul>
<li>Imageï¼šç”¨æ¥å±•ç¤ºå›¾ç‰‡çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIImageView</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">Image</span>.<span class="keyword">init</span>(systemName: <span class="string">"star.fill"</span>).foregroundColor(.yellow)</span></pre></td></tr><tr><td class="code"><pre><span class="line">å¤åˆ¶ä»£ç </span></pre></td></tr></table></figure>

<ul>
<li>Buttonï¼šç”¨äºå¯ç‚¹å‡»çš„æŒ‰é’®ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIButton</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.showingProfile.toggle() &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="type">Image</span>(systemName: <span class="string">"paperplane.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .imageScale(.large)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .accessibility(label: <span class="type">Text</span>(<span class="string">"Right"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .padding()</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">å¤åˆ¶ä»£ç </span></pre></td></tr></table></figure>

<ul>
<li>Listï¼šç”¨æ¥å±•ç¤ºåˆ—è¡¨çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UITableView</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">List</span>(<span class="number">0</span>..&lt;<span class="number">5</span>)&#123;<span class="number">_</span> <span class="keyword">in</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">NavigationLink</span>.<span class="keyword">init</span>(destination: <span class="type">VStack</span>(alignment:.center)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>.<span class="keyword">init</span>(systemName: <span class="string">"\(item+1).square.fill"</span>).foregroundColor(.green)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"è¯¦æƒ…ç•Œé¢\(item + 1)"</span>).font(.system(size: <span class="number">16</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//ListRow</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">       &#125;</span></pre></td></tr></table></figure>

<ul>
<li>ScrollViewï¼šç”¨æ¥æ”¯æŒæ»‘åŠ¨çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UIScrollView</code></li>
<li>Spacerï¼šä¸€ä¸ªçµæ´»çš„ç©ºé—´ï¼Œç”¨æ¥å¡«å……ç©ºç™½çš„ç»„ä»¶</li>
<li>Dividerï¼šä¸€æ¡åˆ†å‰²çº¿ï¼Œç”¨æ¥åˆ’åˆ†åŒºåŸŸçš„ç»„ä»¶</li>
</ul>
<p><strong>å¸ƒå±€ç»„ä»¶</strong></p>
<ul>
<li>VStackï¼šå°†å­è§†å›¾æŒ‰<strong>â€œYè½´ç«–ç›´æ–¹å‘â€</strong>å¸ƒå±€ï¼ˆVertical stackï¼‰</li>
<li>HStackï¼šå°†å­è§†å›¾æŒ‰<strong>â€œXè½´æ°´å¹³æ–¹å‘â€</strong>å¸ƒå±€ï¼ˆHorizontal stackï¼‰</li>
<li>ZStackï¼šå°†å­è§†å›¾æŒ‰<strong>â€œXYä¸¤è½´æ–¹å‘å‡å¯¹é½â€</strong>å¸ƒå±€</li>
</ul>
<p><strong>åŠŸèƒ½ç»„ä»¶</strong></p>
<ul>
<li>NavigationViewï¼šè´Ÿè´£Appä¸­å¯¼èˆªåŠŸèƒ½çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UINavigationView</code></li>
<li>NavigationLinkï¼šè´Ÿè´£Appé¡µé¢è·³è½¬çš„ç»„ä»¶ï¼Œç±»ä¼¼äº<code>UINavigationView</code>ä¸­çš„<code>push</code>ä¸<code>pop</code>åŠŸèƒ½</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">NavigationView</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="type">List</span>(<span class="number">0</span>..&lt;<span class="number">5</span>)&#123;<span class="number">_</span> <span class="keyword">in</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">NavigationLink</span>.<span class="keyword">init</span>(destination: <span class="type">VStack</span>(alignment:.center)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>.<span class="keyword">init</span>(systemName: <span class="string">"\(item+1).square.fill"</span>).foregroundColor(.green)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"è¯¦æƒ…ç•Œé¢\(item + 1)"</span>).font(.system(size: <span class="number">16</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//ListRow</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">       &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.navigationBarTitle(<span class="string">"å¯¼èˆª\(item)"</span>,displayMode: .inline)</span></pre></td></tr></table></figure>

<ul>
<li>TabViewï¼šè´Ÿè´£Appä¸­çš„æ ‡ç­¾é¡µåŠŸèƒ½çš„ç»„ä»¶ï¼Œç±»ä¼¼UIKitä¸­çš„<code>UITabBarController</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">TabView</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="type">Text</span>(<span class="string">"The First Tab"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .tabItem &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"1.square.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"First"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="type">Text</span>(<span class="string">"Another Tab"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .tabItem &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"2.square.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"Second"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="type">Text</span>(<span class="string">"The Last Tab"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .tabItem &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"3.square.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"Third"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.font(.headline)</span></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€SwiftUIå¿«é€Ÿä¸Šæ‰‹å®è·µ"><a href="#ä¸‰ã€SwiftUIå¿«é€Ÿä¸Šæ‰‹å®è·µ" class="headerlink" title="ä¸‰ã€SwiftUIå¿«é€Ÿä¸Šæ‰‹å®è·µ"></a>ä¸‰ã€SwiftUIå¿«é€Ÿä¸Šæ‰‹å®è·µ</h3><p>ä¸‹é¢æ¥å¿«é€Ÿå®ç°ä¸€ä¸ªæœ‰TabViewã€NavigationViewã€Listçš„ç®€å•ç¤ºä¾‹Demo</p>
<p><img src="https://i.loli.net/2019/11/24/1npsrk8Q7tZWgEM.png" alt="å®æ—¶é¢„è§ˆ"></p>
<p><code>SF Symbols</code> æ˜¯ä» <code>iOS 13</code> å’Œ <code>macOS 10.15</code> å¼€å§‹å†…ç½®äºç³»ç»Ÿä¸­çš„å­—ç¬¦å›¾æ ‡åº“ï¼Œå®ƒæä¾›äº†ä¸Šåƒç§å¸¸è§çš„çº¿æ¡å›¾æ ‡ï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥ä»»æ„åœ°ä¸ºå®ƒä»¬è®¾ç½®å°ºå¯¸ï¼Œé¢œè‰²ç­‰å±æ€§ã€‚Apple ç”šè‡³å‡†å¤‡äº†ä¸“é—¨çš„appï¼š<a href="https://developer.apple.com/design/resources/" target="_blank" rel="noopener">SF Symbols</a> æ¥å¸®åŠ©ä½ æŸ¥çœ‹å¯ç”¨çš„ç¬¦å·ï¼š</p>
<p>æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ç”¨è¿™äº›<code>Symbols</code>åˆ¶ä½œä¸ªå°Demo</p>
<ul>
<li>ContentView.swiftï¼š</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContentView</span>: <span class="title">View</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> isLeftNav = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> isRightNav = <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">init</span>() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//ä¿®æ”¹å¯¼èˆªæ æ–‡å­—é¢œè‰²</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">UINavigationBar</span>.appearance().largeTitleTextAttributes = [.foregroundColor: <span class="type">UIColor</span>.systemBlue]</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">UINavigationBar</span>.appearance().titleTextAttributes = [.foregroundColor: <span class="type">UIColor</span>.systemBlue]</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">UINavigationBar</span>.appearance().tintColor = .systemBlue</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">TabView</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// Tab1:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">NavigationView</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">List</span>(<span class="type">Symbols</span>, id:\.<span class="keyword">self</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">ListRow</span>(symbol: $<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .navigationBarTitle(<span class="type">Text</span>(<span class="string">"SF Symbols"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .navigationBarItems(leading: leftNavButton, trailing: rightNavButton)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;.tabItem &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Image</span>.<span class="keyword">init</span>(systemName: <span class="string">"star.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(<span class="string">"Tab1"</span>).font(.subheadline)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// Tab2:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">NavigationView</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(<span class="string">"This is the second tab."</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;.tabItem &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Image</span>.<span class="keyword">init</span>(systemName: <span class="string">"star.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(<span class="string">"Tab2"</span>).font(.subheadline)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> leftNavButton: some <span class="type">View</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.isLeftNav.toggle() &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"person.crop.circle"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .imageScale(.large)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">"Left"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .padding()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .sheet(isPresented: $isLeftNav) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">VStack</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(<span class="string">"Hello, we are QiShare!"</span>).foregroundColor(.blue).font(.system(size: <span class="number">32.0</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">HStack</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Text</span>(<span class="string">"an iOS Team. "</span>).fontWeight(.black).foregroundColor(.purple)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Text</span>(<span class="string">"We are learning SwiftUI."</span>).foregroundColor(.blue)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> rightNavButton: some <span class="type">View</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.isRightNav.toggle() &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"paperplane.fill"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .imageScale(.large)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .accessibility(label: <span class="type">Text</span>(<span class="string">"Right"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .padding()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .sheet(isPresented: $isRightNav, onDismiss: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">print</span>(<span class="string">"dissmiss RrightNav"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">ZStack</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(<span class="string">"This is the Right Navi Button."</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ul>
<li>ListRow.swiftï¼šListå¯¹åº”çš„Cell</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListRow</span>: <span class="title">View</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> symbol: <span class="type">String</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">NavigationLink</span>(destination: <span class="type">ListDetail</span>(symbol: symbol)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">HStack</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">//å›¾ç‰‡</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Image</span>(systemName: symbol)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    .resizable()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    .frame(width: <span class="number">60</span>, height: <span class="number">60</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                    .foregroundColor(<span class="type">Colors</span>.randomElement())</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">//åˆ†å‰²</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Divider</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">//æ–‡å­—</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Text</span>(symbol)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ul>
<li>ListDetail.swiftï¼š</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListDetail</span>: <span class="title">View</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> symbol: <span class="type">String</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="type">VStack</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"Image:"</span>).font(.headline)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Image</span>(systemName: symbol)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .foregroundColor(<span class="type">Colors</span>.randomElement())</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .imageScale(.large)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .scaleEffect(<span class="number">3</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .padding(.bottom, <span class="number">100</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Divider</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">            </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(<span class="string">"Image Name:"</span>).font(.headline)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Text</span>(symbol)</span></pre></td></tr><tr><td class="code"><pre><span class="line">                .font(.largeTitle)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="type">Spacer</span>()</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        .navigationBarTitle(symbol)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>æºç ï¼š<a href="https://github.com/QiShare/Qi_SwiftUI_Demo" target="_blank" rel="noopener">æœ¬æ–‡Demo</a></p>
]]></content>
      <categories>
        <category>SwiftUI</category>
      </categories>
      <tags>
        <tag>SwiftUI</tag>
      </tags>
  </entry>
  <entry>
    <title>iOSåº•å±‚åŸç†æ€»ç»“ - æ¢å¯»OCå¯¹è±¡çš„æœ¬è´¨</title>
    <url>/2018/07/17/iOS%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93%20-%20%E6%8E%A2%E5%AF%BBOC%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9C%AC%E8%B4%A8/</url>
    <content><![CDATA[<p>è½¬è½½è‡ªï¼š<a href="https://www.jianshu.com/p/91a9176851cd" target="_blank" rel="noopener">iOSåº•å±‚åŸç†æ€»ç»“</a></p>
<p>å¯¹å°ç å“¥åº•å±‚ç­è§†é¢‘å­¦ä¹ çš„æ€»ç»“ä¸è®°å½•ã€‚é¢è¯•é¢˜éƒ¨åˆ†ï¼Œé€šè¿‡å¯¹é¢è¯•é¢˜çš„åˆ†ææ¢ç´¢é—®é¢˜çš„æœ¬è´¨å†…å®¹ã€‚</p>
<blockquote>
<p>é¢è¯•é¢˜ï¼šä¸€ä¸ªNSObjectå¯¹è±¡å ç”¨å¤šå°‘å†…å­˜ï¼Ÿ</p>
</blockquote>
<p>æ¢å¯»OCå¯¹è±¡çš„æœ¬è´¨ï¼Œæˆ‘ä»¬å¹³æ—¶ç¼–å†™çš„Objective-Cä»£ç ï¼Œåº•å±‚å®ç°å…¶å®éƒ½æ˜¯C\C++ä»£ç ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1434508-7c3e4ae59cb80fc6.png?imageMogr2/auto-orient/strip%7CimageView2/2/format/webp" alt="img"></p>
<p>OCçš„å¯¹è±¡ç»“æ„éƒ½æ˜¯é€šè¿‡åŸºç¡€C\C++çš„ç»“æ„ä½“å®ç°çš„ã€‚<br>æˆ‘ä»¬é€šè¿‡åˆ›å»ºOCæ–‡ä»¶åŠå¯¹è±¡ï¼Œå¹¶å°†OCæ–‡ä»¶è½¬åŒ–ä¸ºC++æ–‡ä»¶æ¥æ¢å¯»OCå¯¹è±¡çš„æœ¬è´¨</p>
<p>OCå¦‚ä¸‹ä»£ç </p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Hello, World!"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€šè¿‡å‘½ä»¤è¡Œå°†OCçš„mian.mæ–‡ä»¶è½¬åŒ–ä¸ºc++æ–‡ä»¶ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">clang -rewrite-objc main.m -o main.cpp <span class="comment">// è¿™ç§æ–¹å¼æ²¡æœ‰æŒ‡å®šæ¶æ„ä¾‹å¦‚arm64æ¶æ„ å…¶ä¸­cppä»£è¡¨ï¼ˆc plus plusï¼‰</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">ç”Ÿæˆ main.cpp</span></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥æŒ‡å®šæ¶æ„æ¨¡å¼çš„å‘½ä»¤è¡Œï¼Œä½¿ç”¨xcodeå·¥å…· xcrun</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">xcrun</span> <span class="selector-tag">-sdk</span> <span class="selector-tag">iphoneos</span> <span class="selector-tag">clang</span> <span class="selector-tag">-arch</span> <span class="selector-tag">arm64</span> <span class="selector-tag">-rewrite-objc</span> <span class="selector-tag">main</span><span class="selector-class">.m</span> <span class="selector-tag">-o</span> <span class="selector-tag">main-arm64</span><span class="selector-class">.cpp</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line">ç”Ÿæˆ <span class="selector-tag">main-arm64</span><span class="selector-class">.cpp</span></span></pre></td></tr></table></figure>

<p>main-arm64.cpp æ–‡ä»¶ä¸­æœç´¢NSObjcetï¼Œå¯ä»¥æ‰¾åˆ°NSObjcet_IMPLï¼ˆIMPLä»£è¡¨ implementation å®ç°ï¼‰</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹NSObject_IMPLå†…éƒ¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NSObject_IMPL</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class isa;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥çœ‹Classæœ¬è´¨</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> *<span class="title">Class</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//æˆ‘ä»¬å‘ç°Classå…¶å®å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯¹è±¡åº•å±‚å®ç°å…¶å®å°±æ˜¯è¿™ä¸ªæ ·å­ã€‚</span></span></pre></td></tr></table></figure>

<p>æ€è€ƒï¼š ä¸€ä¸ªOCå¯¹è±¡åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å¸ƒå±€çš„ã€‚<br> NSObjcetçš„åº•å±‚å®ç°ï¼Œç‚¹å‡»NSObjcetè¿›å…¥å‘ç°NSObjectçš„å†…éƒ¨å®ç°</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">@interface NSObject &lt;NSObject&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic push</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic ignored <span class="meta-string">"-Wobjc-interface-ivars"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class isa  OBJC_ISA_AVAILABILITY;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic pop</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">@end</span></pre></td></tr></table></figure>

<p>è½¬åŒ–ä¸ºcè¯­è¨€å…¶å®å°±æ˜¯ä¸€ä¸ªç»“æ„ä½“</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NSObject_IMPL</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class isa;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<blockquote>
<p>é‚£ä¹ˆè¿™ä¸ªç»“æ„ä½“å å¤šå¤§çš„å†…å­˜ç©ºé—´å‘¢ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªç»“æ„ä½“åªæœ‰ä¸€ä¸ªæˆå‘˜ï¼ŒisaæŒ‡é’ˆï¼Œè€ŒæŒ‡é’ˆåœ¨64ä½æ¶æ„ä¸­å 8ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªNSObjecå¯¹è±¡æ‰€å ç”¨çš„å†…å­˜æ˜¯8ä¸ªå­—èŠ‚ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å¯ä»¥åŸºæœ¬è§£ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°NSObjectå¯¹è±¡ä¸­è¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œé‚£è¿™äº›æ–¹æ³•ä¸å ç”¨å†…å­˜ç©ºé—´å—ï¼Ÿå…¶å®ç±»çš„æ–¹æ³•ç­‰ä¹Ÿå ç”¨å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•æ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´å¹¶ä¸åœ¨NSObjectå¯¹è±¡ä¸­ã€‚</p>
</blockquote>
<p>ä¸ºäº†æ¢å¯»OCå¯¹è±¡åœ¨å†…å­˜ä¸­å¦‚ä½•ä½“ç°ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢ä¸€æ®µä»£ç </p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSObject</span> *objc = [[<span class="built_in">NSObject</span> alloc] init];</span></pre></td></tr></table></figure>

<p>ä¸Šé¢ä¸€æ®µä»£ç åœ¨å†…å­˜ä¸­å¦‚ä½•ä½“ç°çš„å‘¢ï¼Ÿ</p>
<p>ä¸Šè¿°ä¸€æ®µä»£ç ä¸­ç³»ç»Ÿä¸ºNSObjectå¯¹è±¡åˆ†é…8ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œç”¨æ¥å­˜æ”¾ä¸€ä¸ªæˆå‘˜isaæŒ‡é’ˆã€‚</p>
<p>é‚£ä¹ˆisaæŒ‡é’ˆè¿™ä¸ªå˜é‡çš„åœ°å€å°±æ˜¯ç»“æ„ä½“çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯NSObjcetå¯¹è±¡çš„åœ°å€ã€‚<br> å‡è®¾isaçš„åœ°å€ä¸º0x100400110ï¼Œé‚£ä¹ˆä¸Šè¿°ä»£ç åˆ†é…å­˜å‚¨ç©ºé—´ç»™NSObjectå¯¹è±¡ï¼Œç„¶åå°†å­˜å‚¨ç©ºé—´çš„åœ°å€èµ‹å€¼ç»™objcæŒ‡é’ˆã€‚</p>
<p>objcå­˜å‚¨çš„å°±æ˜¯isaçš„åœ°å€</p>
<p>objcæŒ‡å‘å†…å­˜ä¸­NSObjectå¯¹è±¡åœ°å€ï¼Œå³æŒ‡å‘å†…å­˜ä¸­çš„ç»“æ„ä½“ï¼Œä¹Ÿå°±æ˜¯isaçš„ä½ç½®ã€‚</p>
<h3 id="è‡ªå®šä¹‰ç±»çš„å†…éƒ¨å®ç°"><a href="#è‡ªå®šä¹‰ç±»çš„å†…éƒ¨å®ç°" class="headerlink" title="è‡ªå®šä¹‰ç±»çš„å†…éƒ¨å®ç°"></a>è‡ªå®šä¹‰ç±»çš„å†…éƒ¨å®ç°</h3><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">NSObject</span></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@public</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        Student *stu = [[Student alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        stu -&gt; _no = <span class="number">4</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        stu -&gt; _age = <span class="number">5</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,stu);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr></table></figure>

<p>æŒ‰ç…§ä¸Šè¿°æ­¥éª¤åŒæ ·ç”Ÿæˆc++æ–‡ä»¶ã€‚å¹¶æŸ¥æ‰¾Studentï¼Œæˆ‘ä»¬å‘ç°Student_IMPL</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student_IMPL</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">NSObject_IMPL</span> <span class="title">NSObject_IVARS</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<p>å‘ç°ç¬¬ä¸€ä¸ªæ˜¯ NSObject_IMPLçš„å®ç°ã€‚è€Œé€šè¿‡ä¸Šé¢çš„å®éªŒæˆ‘ä»¬çŸ¥é“NSObject_IMPLå†…éƒ¨å…¶å®å°±æ˜¯Class isa<br> é‚£ä¹ˆæˆ‘ä»¬å‡è®¾ struct NSObject_IMPL NSObject_IVARS; ç­‰ä»·äº Class isa;</p>
<p>å¯ä»¥å°†ä¸Šè¿°ä»£ç è½¬åŒ–ä¸º</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student_IMPL</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class *isa;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<p>å› æ­¤æ­¤ç»“æ„ä½“å ç”¨å¤šå°‘å­˜å‚¨ç©ºé—´ï¼Œå¯¹è±¡å°±å ç”¨å¤šå°‘å­˜å‚¨ç©ºé—´ã€‚å› æ­¤ç»“æ„ä½“å ç”¨çš„å­˜å‚¨ç©ºé—´ä¸ºï¼ŒisaæŒ‡é’ˆ8ä¸ªå­—èŠ‚ç©ºé—´+intç±»å‹_no4ä¸ªå­—èŠ‚ç©ºé—´+intç±»å‹_age4ä¸ªå­—èŠ‚ç©ºé—´å…±16ä¸ªå­—èŠ‚ç©ºé—´</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line">Student *stu = [[Student alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">stu -&gt; _no = <span class="number">4</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">stu -&gt; _age = <span class="number">5</span>;</span></pre></td></tr></table></figure>

<p>é‚£ä¹ˆä¸Šè¿°ä»£ç å®é™…ä¸Šåœ¨å†…å­˜ä¸­çš„ä½“ç°ä¸ºï¼Œåˆ›å»ºStudentå¯¹è±¡é¦–å…ˆä¼šåˆ†é…16ä¸ªå­—èŠ‚ï¼Œå­˜å‚¨3ä¸ªä¸œè¥¿ï¼ŒisaæŒ‡é’ˆ8ä¸ªå­—èŠ‚ï¼Œ4ä¸ªå­—èŠ‚çš„_no ,4ä¸ªå­—èŠ‚çš„_age</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/18569867-7779e69767c0143c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" alt="img"></p>
<p>image.png</p>
<p>sutdentå¯¹è±¡çš„3ä¸ªå˜é‡åˆ†åˆ«æœ‰è‡ªå·±çš„åœ°å€ã€‚è€ŒstuæŒ‡å‘isaæŒ‡é’ˆçš„åœ°å€ã€‚å› æ­¤stuçš„åœ°å€ä¸º0x100400110ï¼Œstuå¯¹è±¡åœ¨å†…å­˜ä¸­å ç”¨16ä¸ªå­—èŠ‚çš„ç©ºé—´ã€‚å¹¶ä¸”ç»è¿‡èµ‹å€¼ï¼Œ_noé‡Œé¢å­˜å‚¨4 ï¼Œ_ageé‡Œé¢å­˜å‚¨5</p>
<p>éªŒè¯Studentåœ¨å†…å­˜ä¸­æ¨¡æ ·</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> Student_IMPL &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class isa;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">NSObject</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@public</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// å¼ºåˆ¶è½¬åŒ–</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">struct</span> Student_IMPL *stuImpl = (__bridge <span class="keyword">struct</span> Student_IMPL *)stu;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"_no = %d, _age = %d"</span>, stuImpl-&gt;_no, stuImpl-&gt;_age); <span class="comment">// æ‰“å°å‡º _no = 4, _age = 5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç å°†ocå¯¹è±¡å¼ºè½¬æˆStudent_IMPLçš„ç»“æ„ä½“ã€‚ä¹Ÿå°±æ˜¯è¯´æŠŠä¸€ä¸ªæŒ‡å‘ocå¯¹è±¡çš„æŒ‡é’ˆï¼ŒæŒ‡å‘è¿™ç§ç»“æ„ä½“ã€‚ç”±äºæˆ‘ä»¬ä¹‹å‰çŒœæƒ³ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ä¸ç»“æ„ä½“åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ç›¸åŒï¼Œé‚£ä¹ˆå¦‚æœå¯ä»¥è½¬åŒ–æˆåŠŸï¼Œè¯´æ˜æˆ‘ä»¬çš„çŒœæƒ³æ­£ç¡®ã€‚ç”±æ­¤è¯´æ˜stuè¿™ä¸ªå¯¹è±¡æŒ‡å‘çš„å†…å­˜ç¡®å®æ˜¯ä¸€ä¸ªç»“æ„ä½“ã€‚</p>
<p>å®é™…ä¸Šæƒ³è¦è·å–å¯¹è±¡å ç”¨å†…å­˜çš„å¤§å°ï¼Œå¯ä»¥é€šè¿‡æ›´ä¾¿æ·çš„è¿è¡Œæ—¶æ–¹æ³•æ¥è·å–ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">class_getInstanceSize([Student <span class="class"><span class="keyword">class</span>])</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">NSLog(@<span class="string">"%zd,%zd"</span>, class_getInstanceSize([NSObject <span class="class"><span class="keyword">class</span>]) ,<span class="type">class_getInstanceSize</span></span>([Student <span class="class"><span class="keyword">class</span>]));</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰“å°ä¿¡æ¯ 8å’Œ16</span></span></pre></td></tr></table></figure>

<h4 id="çª¥æ¢å†…å­˜ç»“æ„"><a href="#çª¥æ¢å†…å­˜ç»“æ„" class="headerlink" title="çª¥æ¢å†…å­˜ç»“æ„"></a>çª¥æ¢å†…å­˜ç»“æ„</h4><p>å®æ—¶æŸ¥çœ‹å†…å­˜æ•°æ®</p>
<p><strong>æ–¹å¼ä¸€ï¼šé€šè¿‡æ‰“æ–­ç‚¹ã€‚</strong><br> Debug Workflow -&gt; viewMemory addressä¸­è¾“å…¥stuçš„åœ°å€</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-1c2f8f333637cb41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>image</p>
<p>ä»ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¯»å–æ•°æ®ä»é«˜ä½æ•°æ®å¼€å§‹è¯»ï¼ŒæŸ¥çœ‹å‰16ä½å­—èŠ‚ï¼Œæ¯å››ä¸ªå­—èŠ‚è¯»å‡ºçš„æ•°æ®ä¸º<br> 16è¿›åˆ¶ 0x0000004(4å­—èŠ‚) 0x0000005(4å­—èŠ‚) isaçš„åœ°å€ä¸º 00D1081000001119(8å­—èŠ‚)</p>
<p><strong>æ–¹å¼äºŒï¼šé€šè¿‡lldbæŒ‡ä»¤xcodeè‡ªå¸¦çš„è°ƒè¯•å™¨</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">memory read <span class="number">0x10074c450</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// ç®€å†™  x 0x10074c450</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// å¢åŠ è¯»å–æ¡ä»¶</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// memory read/æ•°é‡æ ¼å¼å­—èŠ‚æ•°  å†…å­˜åœ°å€</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// ç®€å†™ x/æ•°é‡æ ¼å¼å­—èŠ‚æ•°  å†…å­˜åœ°å€</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¼å¼ xæ˜¯16è¿›åˆ¶ï¼Œfæ˜¯æµ®ç‚¹ï¼Œdæ˜¯10è¿›åˆ¶</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// å­—èŠ‚å¤§å°   bï¼šbyte 1å­—èŠ‚ï¼Œhï¼šhalf word 2å­—èŠ‚ï¼Œwï¼šword 4å­—èŠ‚ï¼Œgï¼šgiant word 8å­—èŠ‚</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šx/<span class="number">4</span>xw    <span class="comment">//   /åé¢è¡¨ç¤ºå¦‚ä½•è¯»å–æ•°æ® wè¡¨ç¤º4ä¸ªå­—èŠ‚4ä¸ªå­—èŠ‚è¯»å–ï¼Œxè¡¨ç¤ºä»¥16è¿›åˆ¶çš„æ–¹å¼è¯»å–æ•°æ®ï¼Œ4åˆ™è¡¨ç¤ºè¯»å–4æ¬¡</span></span></pre></td></tr></table></figure>

<p>åŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡lldbä¿®æ”¹å†…å­˜ä¸­çš„å€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">memory write 0x100400c68 6</span></pre></td></tr><tr><td class="code"><pre><span class="line">å°†_noçš„å€¼æ”¹ä¸ºäº†6</span></pre></td></tr></table></figure>

<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-0f4104937adf7401.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/724/format/webp" alt="img"></p>
<p>image</p>
<blockquote>
<p>é‚£ä¹ˆä¸€ä¸ªNSObjectå¯¹è±¡å ç”¨å¤šå°‘å†…å­˜ï¼Ÿ<br> <strong>NSObjcetå®é™…ä¸Šæ˜¯åªæœ‰ä¸€ä¸ªåä¸ºisaçš„æŒ‡é’ˆçš„ç»“æ„ä½“ï¼Œå› æ­¤å ç”¨ä¸€ä¸ªæŒ‡é’ˆå˜é‡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œå¦‚æœ64bitå ç”¨8ä¸ªå­—èŠ‚ï¼Œå¦‚æœ32bitå ç”¨4ä¸ªå­—èŠ‚ã€‚</strong></p>
</blockquote>
<h2 id="æ›´å¤æ‚çš„ç»§æ‰¿å…³ç³»"><a href="#æ›´å¤æ‚çš„ç»§æ‰¿å…³ç³»" class="headerlink" title="æ›´å¤æ‚çš„ç»§æ‰¿å…³ç³»"></a>æ›´å¤æ‚çš„ç»§æ‰¿å…³ç³»</h2><blockquote>
<p>é¢è¯•é¢˜ï¼šåœ¨64bitç¯å¢ƒä¸‹ï¼Œ ä¸‹é¢ä»£ç çš„è¾“å‡ºå†…å®¹ï¼Ÿ</p>
</blockquote>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Person */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* Student */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">Person</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%zd  %zd"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">              class_getInstanceSize([Person <span class="keyword">class</span>]),</span></pre></td></tr><tr><td class="code"><pre><span class="line">              class_getInstanceSize([Student <span class="keyword">class</span>])</span></pre></td></tr><tr><td class="code"><pre><span class="line">              );</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é“é¢è¯•é¢˜çš„å®è´¨æ˜¯æƒ³é—®ä¸€ä¸ªPersonå¯¹è±¡ï¼Œä¸€ä¸ªStudentå¯¹è±¡åˆ†åˆ«å ç”¨å¤šå°‘å†…å­˜ç©ºé—´ï¼Ÿ</p>
</blockquote>
<p>æˆ‘ä»¬ä¾æ®ä¸Šé¢çš„åˆ†æä¸å‘ç°ï¼Œç±»å¯¹è±¡å®è´¨ä¸Šæ˜¯ä»¥ç»“æ„ä½“çš„å½¢å¼å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œç”»å‡ºçœŸæ­£çš„å†…å­˜å›¾ä¾‹</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-dded6a79a629de09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1056/format/webp" alt="img"></p>
<p>image</p>
<p><strong>æˆ‘ä»¬å‘ç°åªè¦æ˜¯ç»§æ‰¿è‡ªNSObjectçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåº•å±‚ç»“æ„ä½“å†…ä¸€å®šæœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚</strong><br> é‚£ä¹ˆä»–ä»¬æ‰€å çš„å†…å­˜ç©ºé—´æ˜¯å¤šå°‘å‘¢ï¼Ÿå•çº¯çš„å°†æŒ‡é’ˆå’Œæˆå‘˜å˜é‡æ‰€å çš„å†…å­˜ç›¸åŠ å³å¯å—ï¼Ÿä¸Šè¿°ä»£ç å®é™…æ‰“å°çš„å†…å®¹æ˜¯16 16ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œpersonå¯¹è±¡å’Œstudentå¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´éƒ½ä¸º16ä¸ªå­—èŠ‚ã€‚<br> å…¶å®å®é™…ä¸Špersonå¯¹è±¡ç¡®å®åªä½¿ç”¨äº†12ä¸ªå­—èŠ‚ã€‚ä½†æ˜¯å› ä¸ºå†…å­˜å¯¹é½çš„åŸå› ã€‚ä½¿personå¯¹è±¡ä¹Ÿå ç”¨16ä¸ªå­—èŠ‚ã€‚</p>
<blockquote>
<p>ç¼–è¯‘å™¨åœ¨ç»™ç»“æ„ä½“å¼€è¾Ÿç©ºé—´æ—¶ï¼Œé¦–å…ˆæ‰¾åˆ°ç»“æ„ä½“ä¸­æœ€å®½çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç„¶åå¯»æ‰¾å†…å­˜åœ°å€èƒ½æ˜¯è¯¥åŸºæœ¬æ•°æ®ç±»å‹çš„æ•´å€çš„ä½ç½®ï¼Œä½œä¸ºç»“æ„ä½“çš„é¦–åœ°å€ã€‚å°†è¿™ä¸ªæœ€å®½çš„åŸºæœ¬æ•°æ®ç±»å‹çš„å¤§å°ä½œä¸ºå¯¹é½æ¨¡æ•°ã€‚<br> ä¸ºç»“æ„ä½“çš„ä¸€ä¸ªæˆå‘˜å¼€è¾Ÿç©ºé—´ä¹‹å‰ï¼Œç¼–è¯‘å™¨é¦–å…ˆæ£€æŸ¥é¢„å¼€è¾Ÿç©ºé—´çš„é¦–åœ°å€ç›¸å¯¹äºç»“æ„ä½“é¦–åœ°å€çš„åç§»æ˜¯å¦æ˜¯æœ¬æˆå‘˜çš„æ•´æ•°å€ï¼Œè‹¥æ˜¯ï¼Œåˆ™å­˜æ”¾æœ¬æˆå‘˜ï¼Œåä¹‹ï¼Œåˆ™åœ¨æœ¬æˆå‘˜å’Œä¸Šä¸€ä¸ªæˆå‘˜ä¹‹é—´å¡«å……ä¸€å®šçš„å­—èŠ‚ï¼Œä»¥è¾¾åˆ°æ•´æ•°å€çš„è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯å°†é¢„å¼€è¾Ÿç©ºé—´çš„é¦–åœ°å€åç§»å‡ ä¸ªå­—èŠ‚ã€‚</p>
</blockquote>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥æ€»ç»“å†…å­˜å¯¹é½ä¸ºä¸¤ä¸ªåŸåˆ™ï¼š<br> <strong>åŸåˆ™ 1. å‰é¢çš„åœ°å€å¿…é¡»æ˜¯åé¢çš„åœ°å€æ­£æ•°å€,ä¸æ˜¯å°±è¡¥é½ã€‚</strong><br> <strong>åŸåˆ™ 2. æ•´ä¸ªStructçš„åœ°å€å¿…é¡»æ˜¯æœ€å¤§å­—èŠ‚çš„æ•´æ•°å€ã€‚</strong></p>
</blockquote>
<p>é€šè¿‡ä¸Šè¿°å†…å­˜å¯¹é½çš„åŸåˆ™æˆ‘ä»¬æ¥çœ‹ï¼Œpersonå¯¹è±¡çš„ç¬¬ä¸€ä¸ªåœ°å€è¦å­˜æ”¾isaæŒ‡é’ˆéœ€è¦8ä¸ªå­—èŠ‚ï¼Œç¬¬äºŒä¸ªåœ°å€è¦å­˜æ”¾_ageæˆå‘˜å˜é‡éœ€è¦4ä¸ªå­—èŠ‚ï¼Œæ ¹æ®åŸåˆ™ä¸€ï¼Œ8æ˜¯4çš„æ•´æ•°å€ï¼Œç¬¦åˆåŸåˆ™ä¸€ï¼Œä¸éœ€è¦è¡¥é½ã€‚ç„¶åæ£€æŸ¥åŸåˆ™2ï¼Œç›®å‰personå¯¹è±¡å…±å æ®12ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œä¸æ˜¯æœ€å¤§å­—èŠ‚æ•°8ä¸ªå­—èŠ‚çš„æ•´æ•°å€ï¼Œæ‰€ä»¥éœ€è¦è¡¥é½4ä¸ªå­—èŠ‚ï¼Œå› æ­¤personå¯¹è±¡å°±å ç”¨16ä¸ªå­—èŠ‚ç©ºé—´ã€‚</p>
<p>è€Œå¯¹äºstudentå¯¹è±¡ï¼Œæˆ‘ä»¬çŸ¥é“sutdentå¯¹è±¡ä¸­ï¼ŒåŒ…å«personå¯¹è±¡çš„ç»“æ„ä½“å®ç°ï¼Œå’Œä¸€ä¸ªintç±»å‹çš„_noæˆå‘˜å˜é‡ï¼ŒåŒæ ·isaæŒ‡é’ˆ8ä¸ªå­—èŠ‚ï¼Œ_ageæˆå‘˜å˜é‡4ä¸ªå­—èŠ‚ï¼Œ_noæˆå‘˜å˜é‡4ä¸ªå­—èŠ‚ï¼Œåˆšå¥½æ»¡è¶³åŸåˆ™1å’ŒåŸåˆ™2ï¼Œæ‰€ä»¥studentå¯¹è±¡å æ®çš„å†…å­˜ç©ºé—´ä¹Ÿæ˜¯16ä¸ªå­—èŠ‚ã€‚</p>
<h3 id="OCå¯¹è±¡çš„åˆ†ç±»"><a href="#OCå¯¹è±¡çš„åˆ†ç±»" class="headerlink" title="OCå¯¹è±¡çš„åˆ†ç±»"></a>OCå¯¹è±¡çš„åˆ†ç±»</h3><blockquote>
<p>é¢è¯•é¢˜ï¼šOCçš„ç±»ä¿¡æ¯å­˜æ”¾åœ¨å“ªé‡Œã€‚<br> é¢è¯•é¢˜ï¼šå¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘å“ªé‡Œã€‚</p>
</blockquote>
<p>ç¤ºä¾‹ä»£ç </p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* Person */</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCopying</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@public</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="keyword">int</span> height;</span></pre></td></tr><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)personMethod;</span></pre></td></tr><tr><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)personClassMethod;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)personMethod &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)personClassMethod &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* Student */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">Person</span> &lt;<span class="title">NSCoding</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@public</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">int</span> _no;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="keyword">int</span> score;</span></pre></td></tr><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)studentMethod;</span></pre></td></tr><tr><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)studentClassMethod;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)studentMethod &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)studentClassMethod &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">@end</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;      </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSObject</span> *object1 = [[<span class="built_in">NSObject</span> alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">NSObject</span> *object2 = [[<span class="built_in">NSObject</span> alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        Student *stu = [[Student alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        [Student load];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">        Person *p1 = [[Person alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        p1-&gt;_age = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        [p1 personMethod];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        [Person personClassMethod];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        Person *p2 = [[Person alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        p2-&gt;_age = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><strong>OCçš„ç±»ä¿¡æ¯å­˜æ”¾åœ¨å“ªé‡Œ</strong><br> OCå¯¹è±¡ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰ç§</p>
<ol>
<li>instanceå¯¹è±¡ï¼ˆå®ä¾‹å¯¹è±¡ï¼‰</li>
<li>classå¯¹è±¡ï¼ˆç±»å¯¹è±¡ï¼‰</li>
<li>meta-classå¯¹è±¡ï¼ˆå…ƒç±»å¯¹è±¡ï¼‰</li>
</ol>
<p><strong>instanceå¯¹è±¡å°±æ˜¯é€šè¿‡ç±»allocå‡ºæ¥çš„å¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨allocéƒ½ä¼šäº§ç”Ÿæ–°çš„instanceå¯¹è±¡</strong></p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSObjcet</span> *object1 = [[<span class="built_in">NSObjcet</span> alloc] init];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">NSObjcet</span> *object2 = [[<span class="built_in">NSObjcet</span> alloc] init];</span></pre></td></tr></table></figure>

<p>object1å’Œobject2éƒ½æ˜¯NSObjectçš„instaceå¯¹è±¡ï¼ˆå®ä¾‹å¯¹è±¡ï¼‰ï¼Œä½†ä»–ä»¬æ˜¯ä¸åŒçš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åˆ†åˆ«å æ®ç€ä¸¤å—ä¸åŒçš„å†…å­˜ã€‚<br> instanceå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯åŒ…æ‹¬</p>
<ol>
<li>isaæŒ‡é’ˆ</li>
<li>å…¶ä»–æˆå‘˜å˜é‡</li>
</ol>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-c564b99ce9ba8c10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1083/format/webp" alt="img"></p>
<p>image</p>
<blockquote>
<p>è¡ç”Ÿé—®é¢˜ï¼šåœ¨ä¸Šå›¾å®ä¾‹å¯¹è±¡ä¸­æ ¹æœ¬æ²¡æœ‰çœ‹åˆ°æ–¹æ³•ï¼Œé‚£ä¹ˆå®ä¾‹å¯¹è±¡çš„æ–¹æ³•çš„ä»£ç æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿé‚£ä¹ˆç±»çš„æ–¹æ³•çš„ä¿¡æ¯ï¼Œåè®®çš„ä¿¡æ¯ï¼Œå±æ€§çš„ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ</p>
</blockquote>
<p><strong>classå¯¹è±¡</strong><br> æˆ‘ä»¬é€šè¿‡classæ–¹æ³•æˆ–runtimeæ–¹æ³•å¾—åˆ°ä¸€ä¸ªclasså¯¹è±¡ã€‚classå¯¹è±¡ä¹Ÿå°±æ˜¯ç±»å¯¹è±¡</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">Class objectClass1 = [object1 <span class="class"><span class="keyword">class</span>];</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass2 = [object2 <span class="class"><span class="keyword">class</span>];</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass3 = [NSObject <span class="class"><span class="keyword">class</span>];</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// runtime</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass4 = object_getClass(object1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass5 = object_getClass(object2);</span></pre></td></tr><tr><td class="code"><pre><span class="line">NSLog(@<span class="string">"%p %p %p %p %p"</span>, objectClass1, objectClass2, objectClass3, objectClass4, objectClass5);</span></pre></td></tr></table></figure>

<p><strong>æ¯ä¸€ä¸ªç±»åœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªclasså¯¹è±¡ã€‚å¯ä»¥é€šè¿‡æ‰“å°å†…å­˜åœ°å€è¯æ˜</strong></p>
<p>classå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬</p>
<ol>
<li>isaæŒ‡é’ˆ</li>
<li>superclassæŒ‡é’ˆ</li>
<li>ç±»çš„å±æ€§ä¿¡æ¯ï¼ˆ@propertyï¼‰ï¼Œç±»çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼ˆivarï¼‰</li>
<li>ç±»çš„å¯¹è±¡æ–¹æ³•ä¿¡æ¯ï¼ˆinstance methodï¼‰ï¼Œç±»çš„åè®®ä¿¡æ¯ï¼ˆprotocolï¼‰</li>
</ol>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-c3527113c4cc1c08.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/316/format/webp" alt="img"></p>
<p>image</p>
<p><strong>æˆå‘˜å˜é‡çš„å€¼æ—¶å­˜å‚¨åœ¨å®ä¾‹å¯¹è±¡ä¸­çš„ï¼Œå› ä¸ºåªæœ‰å½“æˆ‘ä»¬åˆ›å»ºå®ä¾‹å¯¹è±¡çš„æ—¶å€™æ‰ä¸ºæˆå‘˜å˜èµ‹å€¼ã€‚ä½†æ˜¯æˆå‘˜å˜é‡å«ä»€ä¹ˆåå­—ï¼Œæ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªéœ€è¦æœ‰ä¸€ä»½å°±å¯ä»¥äº†ã€‚æ‰€ä»¥å­˜å‚¨åœ¨classå¯¹è±¡ä¸­ã€‚</strong></p>
<p>ç±»æ–¹æ³•æ”¾åœ¨é‚£é‡Œï¼Ÿ<br> <strong>å…ƒç±»å¯¹è±¡ meta-class</strong></p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//runtimeä¸­ä¼ å…¥ç±»å¯¹è±¡æ­¤æ—¶å¾—åˆ°çš„å°±æ˜¯å…ƒç±»å¯¹è±¡</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectMetaClass = object_getClass([<span class="built_in">NSObject</span> <span class="keyword">class</span>]);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// è€Œè°ƒç”¨ç±»å¯¹è±¡çš„classæ–¹æ³•æ—¶å¾—åˆ°è¿˜æ˜¯ç±»å¯¹è±¡ï¼Œæ— è®ºè°ƒç”¨å¤šå°‘æ¬¡éƒ½æ˜¯ç±»å¯¹è±¡</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class cls = [[<span class="built_in">NSObject</span> <span class="keyword">class</span>] <span class="keyword">class</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass3 = [<span class="built_in">NSObject</span> <span class="keyword">class</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">class_isMetaClass(objectMetaClass) <span class="comment">// åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦ä¸ºå…ƒç±»å¯¹è±¡</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%p %p %p"</span>, objectMetaClass, objectClass3, cls); <span class="comment">// åé¢ä¸¤ä¸ªåœ°å€ç›¸åŒï¼Œè¯´æ˜å¤šæ¬¡è°ƒç”¨classå¾—åˆ°çš„è¿˜æ˜¯ç±»å¯¹è±¡</span></span></pre></td></tr></table></figure>

<p><strong>æ¯ä¸ªç±»åœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªmeta-classå¯¹è±¡ã€‚</strong><br> meta-classå¯¹è±¡å’Œclasså¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”¨é€”ä¸ä¸€æ ·ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬</p>
<ol>
<li>isaæŒ‡é’ˆ</li>
<li>superclassæŒ‡é’ˆ</li>
<li>ç±»çš„ç±»æ–¹æ³•çš„ä¿¡æ¯ï¼ˆclass methodï¼‰</li>
</ol>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-4aca671a18181443.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/328/format/webp" alt="img"></p>
<p>image</p>
<p><strong>meta-classå¯¹è±¡å’Œclasså¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥meta-classä¸­ä¹Ÿæœ‰ç±»çš„å±æ€§ä¿¡æ¯ï¼Œç±»çš„å¯¹è±¡æ–¹æ³•ä¿¡æ¯ç­‰æˆå‘˜å˜é‡ï¼Œä½†æ˜¯å…¶ä¸­çš„å€¼å¯èƒ½æ˜¯ç©ºçš„ã€‚</strong></p>
<p><strong>å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘å“ªé‡Œ</strong></p>
<ol>
<li>å½“å¯¹è±¡è°ƒç”¨å®ä¾‹æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸Šé¢è®²åˆ°ï¼Œå®ä¾‹æ–¹æ³•ä¿¡æ¯æ˜¯å­˜å‚¨åœ¨classç±»å¯¹è±¡ä¸­çš„ï¼Œé‚£ä¹ˆè¦æƒ³æ‰¾åˆ°å®ä¾‹æ–¹æ³•ï¼Œå°±å¿…é¡»æ‰¾åˆ°classç±»å¯¹è±¡ï¼Œé‚£ä¹ˆæ­¤æ—¶isaçš„ä½œç”¨å°±æ¥äº†ã€‚</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">stu studentMethod</span>];</span></pre></td></tr></table></figure>

<p><strong>instanceçš„isaæŒ‡å‘classï¼Œå½“è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œé€šè¿‡instanceçš„isaæ‰¾åˆ°classï¼Œæœ€åæ‰¾åˆ°å¯¹è±¡æ–¹æ³•çš„å®ç°è¿›è¡Œè°ƒç”¨ã€‚</strong></p>
<ol>
<li>å½“ç±»å¯¹è±¡è°ƒç”¨ç±»æ–¹æ³•çš„æ—¶å€™ï¼ŒåŒä¸Šï¼Œç±»æ–¹æ³•æ˜¯å­˜å‚¨åœ¨meta-classå…ƒç±»å¯¹è±¡ä¸­çš„ã€‚é‚£ä¹ˆè¦æ‰¾åˆ°ç±»æ–¹æ³•ï¼Œå°±éœ€è¦æ‰¾åˆ°meta-classå…ƒç±»å¯¹è±¡ï¼Œè€Œclassç±»å¯¹è±¡çš„isaæŒ‡é’ˆå°±æŒ‡å‘å…ƒç±»å¯¹è±¡</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">Student studentClassMethod</span>];</span></pre></td></tr></table></figure>

<p><strong>classçš„isaæŒ‡å‘meta-class<br> å½“è°ƒç”¨ç±»æ–¹æ³•æ—¶ï¼Œé€šè¿‡classçš„isaæ‰¾åˆ°meta-classï¼Œæœ€åæ‰¾åˆ°ç±»æ–¹æ³•çš„å®ç°è¿›è¡Œè°ƒç”¨</strong></p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-e71cf3850379fe21.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1145/format/webp" alt="img"></p>
<p>image</p>
<ol>
<li>å½“å¯¹è±¡è°ƒç”¨å…¶çˆ¶ç±»å¯¹è±¡æ–¹æ³•çš„æ—¶å€™ï¼Œåˆæ˜¯æ€ä¹ˆæ‰¾åˆ°çˆ¶ç±»å¯¹è±¡æ–¹æ³•çš„å‘¢ï¼Ÿï¼Œæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨åˆ°classç±»å¯¹è±¡superclassæŒ‡é’ˆã€‚</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">stu personMethod</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[<span class="meta">stu init</span>];</span></pre></td></tr></table></figure>

<p><strong>å½“Studentçš„instanceå¯¹è±¡è¦è°ƒç”¨Personçš„å¯¹è±¡æ–¹æ³•æ—¶ï¼Œä¼šå…ˆé€šè¿‡isaæ‰¾åˆ°Studentçš„classï¼Œç„¶åé€šè¿‡superclassæ‰¾åˆ°Personçš„classï¼Œæœ€åæ‰¾åˆ°å¯¹è±¡æ–¹æ³•çš„å®ç°è¿›è¡Œè°ƒç”¨ï¼ŒåŒæ ·å¦‚æœPersonå‘ç°è‡ªå·±æ²¡æœ‰å“åº”çš„å¯¹è±¡æ–¹æ³•ï¼Œåˆä¼šé€šè¿‡Personçš„superclassæŒ‡é’ˆæ‰¾åˆ°NSObjectçš„classå¯¹è±¡ï¼Œå»å¯»æ‰¾å“åº”çš„æ–¹æ³•</strong></p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-c424291af118ebad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>image</p>
<ol>
<li>å½“ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»çš„ç±»æ–¹æ³•æ—¶ï¼Œå°±éœ€è¦å…ˆé€šè¿‡isaæŒ‡é’ˆæ‰¾åˆ°meta-classï¼Œç„¶åé€šè¿‡superclasså»å¯»æ‰¾å“åº”çš„æ–¹æ³•</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">Student personClassMethod</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">[<span class="meta">Student load</span>];</span></pre></td></tr></table></figure>

<p><strong>å½“Studentçš„classè¦è°ƒç”¨Personçš„ç±»æ–¹æ³•æ—¶ï¼Œä¼šå…ˆé€šè¿‡isaæ‰¾åˆ°Studentçš„meta-classï¼Œç„¶åé€šè¿‡superclassæ‰¾åˆ°Personçš„meta-classï¼Œæœ€åæ‰¾åˆ°ç±»æ–¹æ³•çš„å®ç°è¿›è¡Œè°ƒç”¨</strong></p>
<p>æœ€ååˆæ˜¯è¿™å¼ é™å®šçš„isaæŒ‡å‘å›¾ï¼Œç»è¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬åœ¨æ¥çœ‹è¿™å¼ å›¾ï¼Œå°±æ˜¾å¾—æ¸…æ™°æ˜äº†å¾ˆå¤šã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-49ba7d6446b3ded2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/449/format/webp" alt="img"></p>
<p>image</p>
<blockquote>
<p><strong>å¯¹isaã€superclassæ€»ç»“</strong></p>
<ol>
<li>instanceçš„isaæŒ‡å‘class</li>
<li>classçš„isaæŒ‡å‘meta-class</li>
<li>meta-classçš„isaæŒ‡å‘åŸºç±»çš„meta-classï¼ŒåŸºç±»çš„isaæŒ‡å‘è‡ªå·±</li>
<li>classçš„superclassæŒ‡å‘çˆ¶ç±»çš„classï¼Œå¦‚æœæ²¡æœ‰çˆ¶ç±»ï¼ŒsuperclassæŒ‡é’ˆä¸ºnil</li>
<li>meta-classçš„superclassæŒ‡å‘çˆ¶ç±»çš„meta-classï¼ŒåŸºç±»çš„meta-classçš„superclassæŒ‡å‘åŸºç±»çš„class</li>
<li>instanceè°ƒç”¨å¯¹è±¡æ–¹æ³•çš„è½¨è¿¹ï¼Œisaæ‰¾åˆ°classï¼Œæ–¹æ³•ä¸å­˜åœ¨ï¼Œå°±é€šè¿‡superclassæ‰¾çˆ¶ç±»</li>
<li>classè°ƒç”¨ç±»æ–¹æ³•çš„è½¨è¿¹ï¼Œisaæ‰¾meta-classï¼Œæ–¹æ³•ä¸å­˜åœ¨ï¼Œå°±é€šè¿‡superclassæ‰¾çˆ¶ç±»</li>
</ol>
</blockquote>
<h3 id="å¦‚ä½•è¯æ˜isaæŒ‡é’ˆçš„æŒ‡å‘çœŸçš„å¦‚ä¸Šé¢æ‰€è¯´ï¼Ÿ"><a href="#å¦‚ä½•è¯æ˜isaæŒ‡é’ˆçš„æŒ‡å‘çœŸçš„å¦‚ä¸Šé¢æ‰€è¯´ï¼Ÿ" class="headerlink" title="å¦‚ä½•è¯æ˜isaæŒ‡é’ˆçš„æŒ‡å‘çœŸçš„å¦‚ä¸Šé¢æ‰€è¯´ï¼Ÿ"></a>å¦‚ä½•è¯æ˜isaæŒ‡é’ˆçš„æŒ‡å‘çœŸçš„å¦‚ä¸Šé¢æ‰€è¯´ï¼Ÿ</h3><p>æˆ‘ä»¬é€šè¿‡å¦‚ä¸‹ä»£ç è¯æ˜ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">NSObject *<span class="keyword">object</span> = [[NSObject alloc] <span class="keyword">init</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass = [NSObject <span class="class"><span class="keyword">class</span>];</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectMetaClass = object_getClass([NSObject <span class="class"><span class="keyword">class</span>]);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">NSLog(@<span class="string">"%p %p %p"</span>, <span class="keyword">object</span>, objectClass, objectMetaClass);</span></pre></td></tr></table></figure>

<p>æ‰“æ–­ç‚¹å¹¶é€šè¿‡æ§åˆ¶å°æ‰“å°ç›¸åº”å¯¹è±¡çš„isaæŒ‡é’ˆ</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-00e99ea5045212df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/407/format/webp" alt="img"></p>
<p>image</p>
<p>æˆ‘ä»¬å‘ç°object-&gt;isaä¸objectClassçš„åœ°å€ä¸åŒï¼Œè¿™æ˜¯å› ä¸ºä»64bitå¼€å§‹ï¼Œisaéœ€è¦è¿›è¡Œä¸€æ¬¡ä½è¿ç®—ï¼Œæ‰èƒ½è®¡ç®—å‡ºçœŸå®åœ°å€ã€‚è€Œä½è¿ç®—çš„å€¼æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹è½½<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fopensource.apple.com%2Ftarballs%2Fobjc4%2F" target="_blank" rel="noopener">objcæºä»£ç </a>æ‰¾åˆ°ã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-276d3011130264db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/453/format/webp" alt="img"></p>
<p>image</p>
<p>æˆ‘ä»¬é€šè¿‡ä½è¿ç®—è¿›è¡ŒéªŒè¯ã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-f2268e81904fb832.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/470/format/webp" alt="img"></p>
<p>image</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œobject-isaæŒ‡é’ˆåœ°å€0x001dffff96537141ç»è¿‡åŒ0x00007ffffffffff8ä½è¿ç®—ï¼Œå¾—å‡ºobjectClassçš„åœ°å€0x00007fff96537140</p>
<p>æ¥ç€æˆ‘ä»¬æ¥éªŒè¯classå¯¹è±¡çš„isaæŒ‡é’ˆæ˜¯å¦åŒæ ·éœ€è¦ä½è¿ç®—è®¡ç®—å‡ºmeta-classå¯¹è±¡çš„åœ°å€ã€‚<br> å½“æˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹å¼æ‰“å°objectClass-&gt;isaæŒ‡é’ˆæ—¶ï¼Œå‘ç°æ— æ³•æ‰“å°</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-38ec0ad027ade31e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1046/format/webp" alt="img"></p>
<p>image</p>
<p>åŒæ—¶ä¹Ÿå‘ç°å·¦è¾¹objectClasså¯¹è±¡ä¸­å¹¶æ²¡æœ‰isaæŒ‡é’ˆã€‚æˆ‘ä»¬æ¥åˆ°Classå†…éƒ¨çœ‹ä¸€ä¸‹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> *<span class="title">Class</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class _Nonnull isa  OBJC_ISA_AVAILABILITY;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !__OBJC2__</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class _Nullable super_class                              OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * _Nonnull name                               OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">long</span> version                                             OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">long</span> info                                                OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">long</span> instance_size                                       OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">objc_ivar_list</span> * _<span class="title">Nullable</span> <span class="title">ivars</span>                  <span class="title">OBJC2_UNAVAILABLE</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">objc_method_list</span> * _<span class="title">Nullable</span> * _<span class="title">Nullable</span> <span class="title">methodLists</span>                    <span class="title">OBJC2_UNAVAILABLE</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">objc_cache</span> * _<span class="title">Nonnull</span> <span class="title">cache</span>                       <span class="title">OBJC2_UNAVAILABLE</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">objc_protocol_list</span> * _<span class="title">Nullable</span> <span class="title">protocols</span>          <span class="title">OBJC2_UNAVAILABLE</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; OBJC2_UNAVAILABLE;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/* Use `Class` instead of `struct objc_class *` */</span></span></pre></td></tr></table></figure>

<p>ç›¸ä¿¡äº†è§£è¿‡isaæŒ‡é’ˆçš„åŒå­¦å¯¹objc_classç»“æ„ä½“å†…çš„å†…å®¹å¾ˆç†Ÿæ‚‰äº†ï¼Œä»Šå¤©è¿™é‡Œä¸æ·±å…¥ç ”ç©¶ï¼Œæˆ‘ä»¬åªçœ‹ç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªisaæŒ‡é’ˆï¼Œä¸ºäº†æ‹¿åˆ°isaæŒ‡é’ˆçš„åœ°å€ï¼Œæˆ‘ä»¬è‡ªå·±åˆ›å»ºä¸€ä¸ªåŒæ ·çš„ç»“æ„ä½“å¹¶é€šè¿‡å¼ºåˆ¶è½¬åŒ–æ‹¿åˆ°isaæŒ‡é’ˆã€‚</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">xx_cc_objc_class</span></span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    Class isa;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">Class objectClass = [NSObject class];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">xx_cc_objc_class</span></span> *objectClass2 = (__bridge <span class="class"><span class="keyword">struct</span> <span class="title">xx_cc_objc_class</span></span> *)(objectClass);</span></pre></td></tr></table></figure>

<p>æ­¤æ—¶æˆ‘ä»¬é‡æ–°éªŒè¯ä¸€ä¸‹</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/1434508-878ba6c819b229a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/499/format/webp" alt="img"></p>
<p>image</p>
<p>ç¡®å®ï¼ŒobjectClass2çš„isaæŒ‡é’ˆç»è¿‡ä½è¿ç®—ä¹‹åçš„åœ°å€æ˜¯meta-classçš„åœ°å€ã€‚</p>
<h3 id="æœ¬æ–‡é¢è¯•é¢˜æ€»ç»“ï¼š"><a href="#æœ¬æ–‡é¢è¯•é¢˜æ€»ç»“ï¼š" class="headerlink" title="æœ¬æ–‡é¢è¯•é¢˜æ€»ç»“ï¼š"></a>æœ¬æ–‡é¢è¯•é¢˜æ€»ç»“ï¼š</h3><ol>
<li>ä¸€ä¸ªNSObjectå¯¹è±¡å ç”¨å¤šå°‘å†…å­˜ï¼Ÿ<br> ç­”ï¼šä¸€ä¸ªæŒ‡é’ˆå˜é‡æ‰€å ç”¨çš„å¤§å°ï¼ˆ64bitå 8ä¸ªå­—èŠ‚ï¼Œ32bitå 4ä¸ªå­—èŠ‚ï¼‰</li>
<li>å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘å“ªé‡Œï¼Ÿ<br> ç­”ï¼šinstanceå¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘classå¯¹è±¡ï¼Œclasså¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘meta-classå¯¹è±¡ï¼Œmeta-classå¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘åŸºç±»çš„meta-classå¯¹è±¡ï¼ŒåŸºç±»è‡ªå·±çš„isaæŒ‡é’ˆä¹ŸæŒ‡å‘è‡ªå·±ã€‚</li>
<li>OCçš„ç±»ä¿¡æ¯å­˜æ”¾åœ¨å“ªé‡Œï¼Ÿ<br> ç­”ï¼šæˆå‘˜å˜é‡çš„å…·ä½“å€¼å­˜æ”¾åœ¨instanceå¯¹è±¡ã€‚å¯¹è±¡æ–¹æ³•ï¼Œåè®®ï¼Œå±æ€§ï¼Œæˆå‘˜å˜é‡ä¿¡æ¯å­˜æ”¾åœ¨classå¯¹è±¡ã€‚ç±»æ–¹æ³•ä¿¡æ¯å­˜æ”¾åœ¨meta-classå¯¹è±¡ã€‚</li>
</ol>
<h3 id="åº•å±‚åŸç†ç›¸å…³æ–‡ç« ï¼š"><a href="#åº•å±‚åŸç†ç›¸å…³æ–‡ç« ï¼š" class="headerlink" title="åº•å±‚åŸç†ç›¸å…³æ–‡ç« ï¼š"></a>åº•å±‚åŸç†ç›¸å…³æ–‡ç« ï¼š</h3><p><a href="https://www.jianshu.com/notebooks/24110540" target="_blank" rel="noopener">iOSåº•å±‚åŸç†æ€»ç»“ - æ–‡é›†</a></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>OC</tag>
      </tags>
  </entry>
</search>
